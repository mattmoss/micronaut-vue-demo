plugins {
    id 'base'
    id 'com.github.node-gradle.node' version '2.2.0'
}

buildDir = 'dist'

node {
    version = '12.5.0'
    yarnVersion = '1.21.1'
    download = true
}

yarn_run_build {
    inputs.files '.env.development', '.env.production', 'babel.config.js', 'yarn.lock'
    inputs.dir 'public'
    inputs.dir 'src'

    outputs.dir buildDir
}

task run {
    dependsOn yarn_run_serve
}

artifacts {
    'default' file: buildDir, type: 'directory', builtBy: yarn_run_build
}

clean.delete << 'node_modules'

